<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Download free Grade 12 study guides, past papers, and expert exam tips from Top Student. Designed for South African learners to boost marks and exam confidence." />
  <meta name="keywords" content="Grade 12 study guides, South Africa matric resources, exam tips, past exam papers, Top Student, study help, revision guides" />
  <meta name="author" content="Top Student by Bellshire" />
  <title>Grade 12 Study Guides | Free Download | Top Student South Africa</title>
  <link rel="icon" type="image/png" sizes="32x32" href="images/favicon.png" />
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <link rel="canonical" href="https://topstudent.co.za/guides.html" />
</head>
<body class="bg-gray-50 text-gray-800 min-h-screen flex flex-col">

 <nav class="bg-gradient-to-r from-blue-800 to-blue-400 shadow-md">
  <div class="container px-4 py-4 flex items-center justify-between">
    <!-- Left: Logo -->
    <div class="flex-shrink-0">
      <img src="images/logo2.png" alt="Top Student Logo" class="h-20 w-auto transition-transform duration-300 hover:scale-105 cursor-pointer" />
    </div>

    <!-- Center: Navigation Links -->
    <ul class="hidden md:flex absolute left-1/2 transform -translate-x-1/2 space-x-6 text-white text-sm font-medium">
      <li><a href="papers.html" class="hover:underline">Papers</a></li>
      <li><a href="guides.html" class="hover:underline">Study Guides</a></li>
      <li><a href="news.html" class="hover:underline">News</a></li>
    </ul>

    <!-- Right: Call and Back -->
    <div class="flex items-center space-x-4 flex-shrink-0">
      <a href="tel:0727306186" title="Call us" class="text-white hover:text-gray-100">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.6a1 1 0 01.94.658l1.4 3.743a1 1 0 01-.21 1.049L9.38 10.2a11.042 11.042 0 005.42 5.42l1.75-1.35a1 1 0 011.049-.21l3.743 1.4a1 1 0 01.658.94V19a2 2 0 01-2 2h-.5C10.074 21 3 13.926 3 5.5V5z" />
        </svg>
      </a>
      <a href="resource.html" title="Back to Resources" class="text-white hover:text-gray-100">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
      </a>
    </div>
  </div>

  <!-- Mobile nav -->
  <div class="md:hidden bg-blue-700 text-white px-4 py-2 space-y-2 text-center">
    <a href="papers.html" class="block hover:underline">Papers</a>
    <a href="guides.html" class="block hover:underline">Study Guides</a>
    <a href="news.html" class="block hover:underline">News</a>
  </div>
</nav>

  <!-- Main Content -->
  <main class="flex-grow flex flex-col items-center text-center px-4 py-8 max-w-4xl mx-auto w-full">
    <h2 class="text-3xl font-semibold mb-8 text-blue-700">Study Guides</h2>
<p class="text-xs text-gray-500 mt-4">
  These study guides are published by the South African Department of Basic Education (DBE) and are freely available to learners. We share them to improve access and support effective exam preparation.
</p>
	<div id="spinner" class="flex justify-center py-10 hidden">
  <div class="animate-spin rounded-full h-12 w-12 border-t-4 border-blue-500 border-opacity-50"></div>
</div>
    <div id="guideList" class="space-y-6 w-full">
    </div>
  </main>

  <!-- Footer -->
  <footer class="text-center text-gray-500 py-4 text-sm">
    &copy; 2025 Top Student. All rights reserved.
  </footer>

  <script type="module">
import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

const supabaseUrl = 'https://mlwxxtvsozhwzjxmsvbg.supabase.co';
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1sd3h4dHZzb3pod3pqeG1zdmJnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg4OTAwOTksImV4cCI6MjA2NDQ2NjA5OX0.i9KySUVeot9imnALKr79DYySocuj0_rko4nzPhPxekU';
const bucketName = 'guides';

const supabase = createClient(supabaseUrl, supabaseKey);

async function loadGuides() {
  const container = document.getElementById('guideList');
  const spinner = document.getElementById('spinner');
  spinner.classList.remove('hidden');
  container.innerHTML = '';

  try {
    const { data: folders, error: foldersError } = await supabase
      .storage
      .from(bucketName)
      .list('', { limit: 100 });

    if (foldersError) {
      spinner.classList.add('hidden');
      container.innerHTML = '<p class="text-red-500">Failed to fetch folders.</p>';
      console.error('Error fetching folders:', foldersError);
      return;
    }

    const validFolders = folders.filter(f => f.name !== '.emptyFolderPlaceholder' && !f.id);

    if (!validFolders.length) {
      spinner.classList.add('hidden');
      container.innerHTML = '<p class="text-gray-500">No folders found in guides bucket.</p>';
      return;
    }

    for (const folder of validFolders) {
      const section = document.createElement('section');
      section.className = 'bg-white rounded shadow p-4 mb-4';

      const btn = document.createElement('button');
      btn.type = 'button';
      btn.className = 'w-full text-left font-semibold text-blue-700 hover:text-blue-900 flex justify-between items-center focus:outline-none';
      btn.setAttribute('aria-expanded', 'false');
      btn.setAttribute('aria-controls', `folder-${folder.name}`);
      btn.id = `btn-${folder.name}`;
      btn.innerHTML = `
        <span class="text-lg"><i class="fas fa-folder mr-2 text-green-600"></i> ${folder.name}</span>
        <svg class="w-5 h-5 transition-transform transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
        </svg>
      `;

      const fileList = document.createElement('ul');
      fileList.id = `folder-${folder.name}`;
      fileList.className = 'mt-3 space-y-2 ml-4 hidden text-left';

      const { data: files, error: filesError } = await supabase
        .storage
        .from(bucketName)
        .list(folder.name, { limit: 100 });

      if (filesError) {
        const errorMsg = document.createElement('li');
        errorMsg.className = 'text-red-500';
        errorMsg.textContent = `Error loading files in "${folder.name}".`;
        fileList.appendChild(errorMsg);
      } else {
        const validPdfs = files.filter(file =>
          file.name !== '.emptyFolderPlaceholder' &&
          file.name.toLowerCase().endsWith('.pdf')
        );

        if (!validPdfs.length) {
          const noFilesMsg = document.createElement('li');
          noFilesMsg.className = 'text-gray-500 italic';
          noFilesMsg.textContent = 'No PDF guides in this folder.';
          fileList.appendChild(noFilesMsg);
        } else {
          for (const file of validPdfs) {
            const fullPath = `${folder.name}/${file.name}`;
            const { data: signed, error: signedError } = await supabase
              .storage
              .from(bucketName)
              .createSignedUrl(fullPath, 60 * 60);

            if (signedError) {
              console.error('Error creating signed URL:', fullPath, signedError);
              continue;
            }

            const li = document.createElement('li');
li.className = 'border p-3 rounded hover:bg-blue-50 flex justify-between md:items-center items-start text-sm flex-col md:flex-row gap-1 md:gap-0';

// ✅ Extract display name for mobile
const match = file.name.match(/(Grd\\d{2}_.*)/);
const displayName = match ? match[1] : file.name;

// ✅ Responsive layout: mobile = stacked, desktop = inline
li.innerHTML = `
  <div class="w-full md:w-auto truncate max-w-full" title="${file.name}">
    <span class="block md:hidden">${displayName}</span>
    <span class="hidden md:block">${file.name}</span>
  </div>
  <div class="w-full md:w-auto text-right">
    <a href="${signed.signedUrl}" target="_blank" rel="noopener" download class="text-blue-600 hover:underline font-semibold block md:inline">
      Download
    </a>
  </div>
`;
            fileList.appendChild(li);
          }
        }
      }

      btn.addEventListener('click', () => {
        const isExpanded = btn.getAttribute('aria-expanded') === 'true';
        btn.setAttribute('aria-expanded', String(!isExpanded));
        fileList.classList.toggle('hidden');
        btn.querySelector('svg').classList.toggle('rotate-180');
      });

      section.appendChild(btn);
      section.appendChild(fileList);
      container.appendChild(section);
    }

  } catch (err) {
    container.innerHTML = '<p class="text-red-500">Unexpected error loading guides.</p>';
    console.error('Unexpected error:', err);
  } finally {
    spinner.classList.add('hidden');
  }
}

loadGuides();
</script>
</body>
</html>

